---
title: "Tölvuverkefni 3"
author: "Ásmundur Óskar Ásmundsson (aoa27@hi.is) og Helgi Sigtryggsson (hes86@hi.is)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r pakkar, include=FALSE}
library(readr)
library(dplyr)
library(lubridate)
library(ggplot2)
library(kableExtra)
library(tidyr)
```

## a) liður
Byrjum á því að lesa inn gögnin:
```{r, lesa gögn}
ah <- read.csv("data98.csv", sep=",")
```

```{r, búum til nýjar breytur}
r2d <-
function(r)
{
	lat <- floor(r/100)
	lon <- (r - lat * 100) %% 50
	halfb <- (r - 100 * lat - lon)/100
	lon <-  - (lon + 0.5)
	lat <- lat + 60 + halfb + 0.25
	data.frame(lat = lat, lon = lon)
}
latitude<- r2d(ah$reit)$lat
longtitude <- r2d(ah$reit)$lon
hafsvaedi <- ifelse(latitude < 65, 
                    ifelse(longtitude < -19, "SV","SA"),
                    ifelse(longtitude < -19, "NV","NAu")
                    )
kt2 <- ifelse(ah$kt == 1, "Ókynþroska", "Kynþroska")
ah <- ah %>%
  mutate(hafsvaedi = factor(hafsvaedi), 
         kt2 = factor(kt2)
         )
```


## b) liður
```{r, tafla fyrir fjölda fiska af hvoru kynþroskastigi eftir hafsvæðum}
ah %>%
  group_by(hafsvaedi, kt2) %>%
  count(kt2, name="fjoldi")
```

```{r, tafal fyrir sem sýnir kynþroskahlutfall á hverju hafsvæði}
ah %>%
  group_by(hafsvaedi, kt2) %>%
  count(kt2, name="fjoldi")# %>%
  #mutate(hlutfall = fjoldi[kt2 == "Kynþroska"])
```

## c) liður
```{r, tafla sem sýnir fjölda fiska, meðallengd, meðalþyngd og staðalfrávik lengdar eftir aldri}
tafla <- ah %>%
  group_by(aldur) %>%
  summarise("Fjöldi fiska" = length(aldur),
            "Meðallengd" = mean(le),
            "Meðalþyngd" =mean(osl),
            "Staðalfrávik lengdar" = sd(le))
```
Úr töflunni má lesa að flestir fiskar eru þriggja til sex ára. Fáir fiskar eru yngri en þriggja ára og fiskum eldri en sex ára fer hratt minnkandi. Þá eykst lengd fiskanna með hækkandi aldri og dreifnin á gildi lengda verður meiri með hækkandi aldri. Þá þyngjast fiskarnir með hækkandi aldri.

```{r, Mynd sem sýnir lengd fiska eftir aldri}
ggplot(ah, aes(x = aldur, y = le)) + labs(x = "Aldur", y = "Lengd") +
  geom_point(color=1, size=1) +
  geom_point(tafla, aes(x = aldur, y = aldur_medaltal)) + 
  geom_point(color=2, size=2)
```
```{r}
  ggplot(ah,aes(x = aldur, y = le)) + labs(
        x = "Aldur",
        y = "Lengd"
    ) +
    geom_boxplot()
```
## d) liður

## e) liður

## f) liður

## g) liður

## h) liður

## i) liður

## j) liður

## k) liður

## Bónusspurning
