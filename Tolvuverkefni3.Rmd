---
title: "Tölvuverkefni 3"
author: "Ásmundur Óskar Ásmundsson (aoa27@hi.is) og Helgi Sigtryggsson (hes86@hi.is)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r pakkar, include=FALSE}
library(readr)
library(dplyr)
library(lubridate)
library(ggplot2)
library(kableExtra)
library(tidyr)
```

## a) liður
Byrjum á því að lesa inn gögnin:
```{r, lesa gögn}
ah <- read.csv("data98.csv", sep=",")
```

```{r, búum til nýjar breytur}
r2d <-
function(r)
{
	lat <- floor(r/100)
	lon <- (r - lat * 100) %% 50
	halfb <- (r - 100 * lat - lon)/100
	lon <-  - (lon + 0.5)
	lat <- lat + 60 + halfb + 0.25
	data.frame(lat = lat, lon = lon)
}
latitude<- r2d(ah$reit)$lat
longtitude <- r2d(ah$reit)$lon
hafsvaedi <- ifelse(latitude < 65, 
                    ifelse(longtitude < -19, "SV","SA"),
                    ifelse(longtitude < -19, "NV","NAu")
                    )
kt2 <- ifelse(ah$kt == 1, "Ókynþroska", "Kynþroska")
ah <- ah %>%
  mutate(hafsvaedi = factor(hafsvaedi), 
         kt2 = factor(kt2)
         )
```


## b) liður
```{r, tafla fyrir fjölda fiska af hvoru kynþroskastigi eftir hafsvæðum}
taflab <- ah %>%
  group_by("Hafsvæði" = hafsvaedi,kt2) %>%
  count(kt2, name="Fjöldi")
taflab
```

```{r, tafla sem sýnir kynþroskahlutfall á hverju hafsvæði}
c <- vector()
f <- vector()
for (i in 1:4)
  c[i] = taflab$Fjöldi[2*i-1]+taflab$Fjöldi[2*i]
for (i in 1:8)
  f[i] = taflab$Fjöldi[i]/c[ceiling(i/2)]
taflab[ , "Hlutfall"] <- f
taflab
```
```{r, Mynd sem er lýsandi fyrir fjölda fiska af hvoru kynþroskastigi í hverjum flokki af hafsvæðunum fjórum}
ggplot(ah, aes(hafsvaedi, fill=kt2)) + geom_bar(position='dodge') +
xlab("Hafsvæði") + ylab("Fjöldi")
```

## c) liður
```{r, tafla sem sýnir fjölda fiska, meðallengd, meðalþyngd og staðalfrávik lengdar eftir aldri}
taflac <- ah %>%
  group_by(aldur) %>%
  summarise("Fjöldi fiska" = length(aldur),"Meðallengd" = mean(le), "Meðalþyngd" =mean(osl), "Staðalfrávik lengdar" = sd(le)) #%>% kable(align = "lllll") %>%
  #kable_styling()
taflac
```
Úr töflunni má lesa að flestir fiskar eru þriggja til sex ára. Fáir fiskar eru yngri en þriggja ára og fiskum eldri en sex ára fer hratt minnkandi. Þá eykst lengd fiskanna með hækkandi aldri og dreifnin á gildi lengda verður meiri með hækkandi aldri. Þá þyngjast fiskarnir með hækkandi aldri.

```{r, Mynd sem sýnir lengd fiska eftir aldri}
  ggplot(ah, aes(x = aldur, y = le)) + labs(
        title = "Graf sem sýnir lengd fiska eftir aldri",
        x = "Aldur",
        y = "Lengd"
    ) +
    geom_point(color = 1, size = 2) +
    geom_point(aes(x = aldur, y = Meðallengd),taflac, color = 2, size = 3)
```

```{r, Kassarit sem sýnir lengd fiska eftir aldri}
  ah$aldur <- factor(ah$aldur)
  ggplot(ah,aes(x = aldur, y = le)) + labs(
        x = "Aldur",
        y = "Lengd"
    ) +
    geom_boxplot()
```
##!!!!!!!!!!!!Hér vantar að svara spurningum úr c lið!!!!!!!!!!!!!!!!!!!!
## d) liður
```{r, Tvö hafsvæði valin á slembin hátt, gerum töflu með 50 fiskum af hvoru gefnu hafsvæði}
set.seed(3110)
(svaedi<-sample(unique(hafsvaedi),2))
hafsvaedi1 <- filter(ah, hafsvaedi == "NV")
hafsvaedi2 <- filter(ah, hafsvaedi == "NAu")
set.seed(3110)
fiskar1 <- sample_n(hafsvaedi1, 50)
set.seed(3110)
fiskar2 <- sample_n(hafsvaedi2, 50)
fiskar <- rbind(fiskar1, fiskar2)
```

## e) liður

## f) liður

## g) liður

## h) liður

## i) liður

## j) liður

## k) liður

## Bónusspurning